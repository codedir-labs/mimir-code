# Security Analysis Command
# Analyzes git diffs for security vulnerabilities and issues
# Usage: /security [file-or-commit]

name: security
description: Analyze git changes for security vulnerabilities
usage: /security [file-or-commit]
aliases: [sec, vuln]
prompt: |
  Perform a comprehensive security analysis of the git diff. Focus on:

  **Critical Security Issues:**
  - SQL injection vulnerabilities (unsanitized input in queries)
  - XSS vulnerabilities (unescaped output in HTML/templates)
  - Command injection (unsanitized shell execution)
  - Path traversal (directory traversal attacks via user input)
  - Authentication/authorization bypass
  - Hardcoded secrets, API keys, passwords, or tokens
  - Insecure cryptography (weak algorithms, hardcoded keys)
  - CSRF vulnerabilities (missing tokens on state-changing operations)

  **High-Priority Issues:**
  - Input validation gaps (missing sanitization, type checking)
  - Unsafe deserialization
  - Race conditions in concurrent code
  - Information disclosure in error messages
  - Insecure defaults or misconfigurations
  - Missing security headers
  - Weak password policies

  **Best Practices:**
  - Principle of least privilege violations
  - Missing rate limiting
  - Inadequate logging of security events
  - Unencrypted sensitive data transmission
  - Missing input length/size limits

  **Analysis Target:**
  $ARGUMENTS

  **Output Format:**
  1. Executive Summary (severity: critical/high/medium/low)
  2. Detailed findings with:
     - File path and line numbers
     - Vulnerability type (OWASP category)
     - Proof of concept/exploit scenario
     - Remediation code snippet
  3. Risk assessment and prioritization

  If no target specified, analyze the current staged changes (git diff --staged).
  Be thorough but concise. Flag false positives as "Needs Review".
