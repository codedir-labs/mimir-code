# Code Review Command
# Performs comprehensive code review with best practices
# Usage: /review [file-or-commit]

name: review
description: Perform comprehensive code review
usage: /review [file-or-commit]
aliases: [cr, check]
prompt: |
  Conduct a thorough code review of the specified changes. Evaluate:

  **Correctness:**
  - Logic errors and bugs
  - Off-by-one errors
  - Null pointer/undefined access
  - Race conditions and concurrency issues
  - Error handling completeness

  **Code Quality:**
  - Readability and maintainability
  - Naming conventions (clear, consistent)
  - Function/method length and complexity
  - Code duplication (DRY principle)
  - Single Responsibility Principle

  **Performance:**
  - Algorithmic complexity (O(n) analysis)
  - Unnecessary database queries (N+1 problems)
  - Memory inefficiencies
  - Blocking operations in async contexts

  **Testing:**
  - Test coverage for new code
  - Test quality (meaningful assertions)
  - Edge cases covered
  - Mocking strategy appropriateness

  **Security:**
  - Input validation
  - SQL injection, XSS, CSRF risks
  - Authentication/authorization checks
  - Sensitive data exposure

  **Architecture:**
  - Consistency with project patterns
  - API design (backward compatibility)
  - Dependency management
  - Separation of concerns

  **Target:**
  $ARGUMENTS

  **Output Format:**
  1. Overall assessment (LGTM, Needs Work, Requires Changes)
  2. Critical issues (must fix before merge)
  3. Suggestions (nice-to-have improvements)
  4. Positive feedback (what's done well)
  5. Line-specific comments with file:line references

  If no target specified, review the current staged changes.
  Be constructive and specific. Provide code snippets for fixes.
  Balance thoroughness with pragmatism.
