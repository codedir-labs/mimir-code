yarn typecheck
yarn test:unit

# Run comprehensive security audit before push
echo "ğŸ”’ Running comprehensive security audit..."
yarn audit --level moderate || {
  AUDIT_EXIT_CODE=$?
  if [ $AUDIT_EXIT_CODE -ge 16 ]; then
    echo "âŒ Audit failed with error"
    exit 1
  elif [ $AUDIT_EXIT_CODE -gt 0 ]; then
    echo "âŒ Moderate+ vulnerabilities found - push blocked"
    echo "Run 'yarn audit' to review and fix vulnerabilities"
    exit 1
  fi
}
echo "âœ… Security audit passed"
